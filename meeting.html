<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jadwal Meeting</title>

  <style>
    body {   
      margin: 0;
      padding: 20px;
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(
          0deg,
          rgba(0, 0, 0, 0.55),
          rgba(0, 0, 0, 0.55)
        ),
        url("mas.png") no-repeat center/cover;
      color: #fff;
    }

    .logo {
      display: block;
      width: 130px;
      margin: 0 auto 10px;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    #clock {
      margin-right: auto;
      font-weight: 600;
      background: rgba(255, 255, 255, 0.2);
      padding: 6px 12px;
      border-radius: 10px;
      backdrop-filter: blur(6px);
    }

    .btn {
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
    }

    .btn-login { background: #00d4ff; color: #000; }
    .btn-logout { background: #ff4d4d; color: #fff; }

    .container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .column {
      flex: 1;
      background: rgba(255, 255, 255, 0.15);
      padding: 16px;
      border-radius: 18px;
      min-width: 260px;
    }

    .column h3 {
      text-align: center;
      margin: 6px 0 14px;
    }

    .booking {
      background: rgba(255, 255, 255, 0.25);
      padding: 14px;
      border-radius: 14px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: 0.25s;
    }

    .booking:hover {
      transform: scale(1.02);
      background: rgba(255, 255, 255, 0.35);
    }

    .booking.live {
      background: rgba(0, 255, 120, 0.22) !important;
      border: 2px solid rgba(0, 255, 120, 0.65);
      box-shadow: 0 0 8px rgba(0, 255, 120, 0.35);
    }

    .booking.live::before {
      content: "‚óè ";
      display: inline-block;
      font-size: 11px;
      font-weight: bold;
      color: rgba(0, 255, 120, 0.9);
      margin-bottom: 6px;
    }

    .icon-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 16px;
      margin-right: 6px;
    }

    .icon-delete { color: #ff4d4d; }
    .icon-edit { color: #00d4ff; }

    .fab {
      position: fixed;
      right: 24px;
      bottom: 24px;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00d4ff, #0090ff);
      color: #fff;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      text-decoration: none;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
      backdrop-filter: blur(8px);
    }

    .modal-box {
      background: linear-gradient(
          rgba(0, 0, 0, 0.55),
          rgba(0, 0, 0, 0.55)
        ),
        url("citylight.png") no-repeat center/cover;
      color: #fff;
      padding: 26px;
      width: 360px;
      border-radius: 22px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      animation: popup 0.35s ease;
    }

    @keyframes popup {
      from { transform: scale(0.85); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 6px 0;
    }
  </style>
</head>

<body>

<div class="top-bar">
  <div id="clock">--</div>
  <button id="loginBtn" class="btn btn-login">@</button>
  <button id="logoutBtn" class="btn btn-logout" style="display: none">
    Logout
  </button>
</div>

<img src="map-log.png" class="logo" />

<h1>
  Jadwal Penggunaan Ruang Meeting <br />
  PT Mitra Asa Pratama
</h1>

<div class="container">
  <div class="column">
    <h3>Ruang Arjuna</h3>
    <div id="arjuna"></div>
  </div>
  <div class="column">
    <h3>Ruang Srikandi</h3>
    <div id="srikandi"></div>
  </div>
  <div class="column">
    <h3>Ruang Gatot Kaca</h3>
    <div id="gatot"></div>
  </div>
</div>

<a href="daftar.html" class="fab" id="addBtn">+</a>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycby_Ib2KyhAnT9QuX4LIJ_JvK5WZB5edi4Tb4sy_4sx7MzaPs0wpxnMm7rS5vKFTzUSF/exec";

let DATA = [];

/* ===========================
   LIVE CHECK
=========================== */
function isLiveBooking(d) {
  const now = new Date();
  const start = new Date(d.tanggal + "T" + d.mulai);
  const end   = new Date(d.tanggal + "T" + d.selesai);
  return now >= start && now <= end;
}

/* ===========================
   LOAD DATA (SORT BARU)
=========================== */
async function loadData() {
  const r = await fetch(API_URL + "?_=" + Date.now());
  DATA = await r.json();

  const now = new Date();

  DATA.sort((a, b) => {
    const da = new Date(a.tanggal + "T" + a.mulai);
    const db = new Date(b.tanggal + "T" + b.mulai);

    const diffA = da - now;
    const diffB = db - now;

    return diffA - diffB;
  });

  render();
}

/* ===========================
   RENDER
=========================== */
function render() {
  arjuna.innerHTML = "";
  srikandi.innerHTML = "";
  gatot.innerHTML = "";

  DATA.forEach(d => {
    const el = document.createElement("div");
    el.className = "booking";

    if (isLiveBooking(d)) el.classList.add("live");

    el.innerHTML = `
      <b>${d.agenda}</b><br>
      üìÖ ${d.tanggal}<br>
      ‚è∞ ${d.mulai} - ${d.selesai}<br>
      üë§ ${d.nama}
    `;

    const r = d.ruangan.toLowerCase();
    if (r.includes("arjuna")) arjuna.appendChild(el);
    if (r.includes("srikandi")) srikandi.appendChild(el);
    if (r.includes("gatot")) gatot.appendChild(el);
  });
}

/* ===========================
   CLOCK
=========================== */
setInterval(() => {
  clock.textContent = new Date().toLocaleString("id-ID");
}, 1000);

loadData();
</script>

</body>
</html>
