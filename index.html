<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Ruang Meeting</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" />
  <script>
    const calendarIds = {
      arjuna: "dc49966a239199414780de061d7d0cb226e45b4398f1585fd46950f2a44bcc2d@group.calendar.google.com",
      srikandi: "4b908ab3e0e0eecd09957c9cf6c2d124039222e96112a13ce10a1a322a78b753@group.calendar.google.com",
      gatotkaca: "a1c8e0d5a5c5c870325fc8bca859002f0c4c2523876bef16176e960312fe68b2@group.calendar.google.com"
    };

    const apiKey = "AIzaSyBee80FlAkCPEy4O5lbSgS2ygmetMY0_2w";

    async function checkRoomStatus(calendarId) {
      const now = new Date().toISOString();
      const maxTime = new Date(Date.now() + 60 * 60 * 1000).toISOString();
      const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=${apiKey}&timeMin=${now}&timeMax=${maxTime}&singleEvents=true&orderBy=startTime`;
      const res = await fetch(url);
      const data = await res.json();
      return (data.items && data.items.length > 0) ? "Dipakai" : "Tersedia";
    }

    async function updateStatus() {
      const statusIds = ["arjuna", "srikandi", "gatotkaca"];
      for (const id of statusIds) {
        const status = await checkRoomStatus(calendarIds[id]);
        const label = document.getElementById(`status-${id}`);
        label.textContent = status;
        label.className = status === "Tersedia" ? "text-green-600 font-semibold" : "text-red-600 font-semibold";
      }
    }

    window.onload = () => {
      updateStatus();
      setInterval(updateStatus, 60000);
    }
  </script>
</head>
<body class="bg-gray-100 min-h-screen p-4">
  <header class="flex items-center space-x-4">
    <img src="LOGO MAP.jpg" alt="Logo" class="h-12" />
    <h1 class="text-2xl font-bold">Dashboard Peminjaman Ruang Meeting</h1>
  </header>

  <main class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="bg-white p-4 rounded shadow">
      <h2 class="text-xl font-semibold">Ruang Arjuna</h2>
      <p id="status-arjuna" class="text-gray-500">Memuat...</p>
      <a href="https://forms.gle/yourGoogleFormID?entry.123456=Arjuna" target="_blank">
        <button class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Ajukan Peminjaman</button>
      </a>
    </div>

    <div class="bg-white p-4 rounded shadow">
      <h2 class="text-xl font-semibold">Ruang Srikandi</h2>
      <p id="status-srikandi" class="text-gray-500">Memuat...</p>
      <a href="https://forms.gle/yourGoogleFormID?entry.123456=Srikandi" target="_blank">
        <button class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Ajukan Peminjaman</button>
      </a>
    </div>

    <div class="bg-white p-4 rounded shadow">
      <h2 class="text-xl font-semibold">Ruang Gatotkaca</h2>
      <p id="status-gatotkaca" class="text-gray-500">Memuat...</p>
      <a href="https://forms.gle/yourGoogleFormID?entry.123456=Gatotkaca" target="_blank">
        <button class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Ajukan Peminjaman</button>
      </a>
    </div>
  </main>

  <footer class="text-center mt-10 text-gray-600 text-sm">Â© 2025 PT Mitra Asa Pratama</footer>
</body>
</html>
